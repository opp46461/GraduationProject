try{let ae=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},he=new ae.Error().stack;he&&(ae._sentryDebugIds=ae._sentryDebugIds||{},ae._sentryDebugIds[he]="2fc45eca-42ad-4632-bd92-02e7854529d9",ae._sentryDebugIdIdentifier="sentry-dbid-2fc45eca-42ad-4632-bd92-02e7854529d9")}catch(ae){}{let ae=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};ae.SENTRY_RELEASE={id:"22.10.4"}}(()=>{"use strict";var ae={9820:n=>{n.exports=html2canvas},16700:n=>{n.exports=canvg},18183:(n,w,e)=>{e.d(w,{Dw:()=>u,H:()=>c,QQ:()=>k,X9:()=>I,o$:()=>f});const f="/proto",u=S=>f+"/"+S,M=S=>{const p=/^\/proto\/design\/(?:([^/]+?))$/i.exec(S);return p?p[1]:new Error("project cid error")},c=S=>{let{search:p,pathname:s}=S;if(s.includes("/sharing"))return s.includes("dashboard")||s.includes("htmlzip")?s.split("/").at(-3):s.includes("embed/v2")?location.pathname.split("/").at(-4):s.split("/").at(-2);{const P=new URLSearchParams(p).get("token");if(P)return P;const d=/^\/proto\/([^/]+?)(?:\/forum|\/uichina|\/embed|\/embed\/v2|\/htmlzip|\/sharing|\/ro)?\/?$/i.exec(s);return d?d[1]:""}},D=S=>{let{pathname:p}=S;const s=/^\/proto\/design\/([^/]+)\/?$/i.exec(p);return s?s[1]:""},I=S=>{let{search:p,pathname:s}=S;return c({search:p,pathname:s})||D({pathname:s})},k="/p2mkt_view",E=S=>k+"/"+S,o=S=>/^\/p2mkt_view\/(?:([^/]+?))$/i.exec(S)[1]},23767:(n,w,e)=>{e.d(w,{Bf:()=>o,Ff:()=>u,xZ:()=>M});var f=e(88987);const u=Symbol("PROJECT_VERSION_AUTO_SAVE"),M=Symbol("PROJECT_VERSION_SAVE"),c=Symbol("PROJECT_ENTRY_DESIGN"),D=Symbol("PROJECT_ENTRY_PREVIEW"),I=Symbol("PROJECT_ENTRY_SHARE"),k={[u]:1013,[M]:1014,[c]:1017,[D]:1018,[I]:1019},E={[u]:4,[M]:4,[c]:6,[D]:6,[I]:6},o=async(S,p)=>{await(0,f.VX)({actionType:E[S],action:k[S],orgCid:p.orgCid,extra:{user_name:p.userName,project_name:p.projectName}})}},28501:(n,w,e)=>{var f=e(70768),u=e(68818),M=e(55769),c=e(39096);const D={"sk-bouncedelay":"ZdD58bXGNcNoQjiPeXLu"},I={"sk-bouncedelay":"ZBrU7Yes6CevGkk6hArA"};var k=e(70526);e(17730),e(43435);var E=e(95549),o=e(38502),S=e(83565),p=e(18381),s=e(63115),P=e(9338),d=e(29767),L=e(24437),z=e(28731),F=e(72214);class Q extends o.PureComponent{constructor(i){super(i),(0,E.A)(this,"handleGetViewMode",()=>{var R;const{store:Z,isHtmlZip:J}=this.props,re=new URLSearchParams(location.search).get("view_mode");return J?Z==null||(R=Z.getState())==null||(R=R.editor)==null||(R=R.state)==null||(R=R.mode)==null?void 0:R.previewViewMode:re});const{store:g,projectBasic:B,projectMeta:C,isHtmlZip:W}=i,K=new URLSearchParams(location.search);let V="",r="";const m=K.get("view_mode");if(["read_only","inspect"].includes(m)){var U;V=K.get("screen")||(g==null||(U=g.getState())==null||(U=U.current.currentScreen)==null?void 0:U.cid)||"",r=K.get("canvasId")||""}this.state={visibleIsEmpty:!1};try{const R=(0,L.rV)(V);g.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:B,projectMeta:C,screenCid:R,canvasCid:r,isHtmlZip:W}})}catch(R){this.state={visibleIsEmpty:!0}}}componentDidMount(){this.props.onComponentDidMount(),window.addEventListener("message",z.a,!1),this.handleGetViewMode()==="inspect"&&MB.__store__.dispatch({type:"entry:handle-tool:toggle:inspect-mode",payload:{mode:!0}})}componentWillUnmount(){window.removeEventListener("message",z.a,!1)}render(){const{store:i}=this.props;return this.state.visibleIsEmpty?(0,d.V)():(0,F.jsx)(p.Kq,{store:i,children:(0,F.jsx)(P.A,{children:(0,F.jsx)(s.A,{})})})}}var t=e(79388);const a=async A=>{let{projectMetaCid:i}=A;await(0,t.F2)({userId:void 0,flpakKey:i,onTransferError:t.z0,onReadOnlyError:t.sH,isDummyCmt:!0,__fetchFlpakAsync:u.BD},void 0)};var O=e(22215);const x=function(A,i,g){const B=i.getGuidesData()||"[]",C=new Set(JSON.parse(B)),W=new Set,K=new Map,V={checkGuideHasShown:r=>ENV.IS_ON_PREMISES||C.has(r),checkGuideToBeShown:r=>W.has(r),getState:()=>({commonGuidesHasShown:Array.from(C),commonGuidesToBeShown:Array.from(W),mountGuidesMap:K}),tryToShowGuide:r=>{var m;if(C.has(r)||!((m=MB)!=null&&(m=m.user)!=null&&m.id)||ENV.IS_ON_PREMISES)return;const U=document.getElementById("MD_"+r);if(U){U.style.display="block";return}W.add(r),(0,O.o)(r,A,g)},markGuideAsRead:r=>{C.add(r),i.setGuidesData(JSON.stringify(Array.from(C)))},batchMarkGuideAsRead:r=>{r.forEach(m=>C.add(m)),i.setGuidesData(JSON.stringify(Array.from(C)))},closeAndMarkGuideAsRead:r=>{V.checkGuideHasShown(r)||(V.closeGuide(r),V.markGuideAsRead(r))},closeGuide:r=>{const m=document.getElementById("MD_"+r);m&&m.parentNode&&m.parentNode.removeChild(m)},closeAllGuide:()=>{const r=document.getElementById("GUIDES");r&&r.parentNode&&r.parentNode.removeChild(r)},hideAllGuides:()=>{const r=document.getElementById("GUIDES");r&&Array.from(r.children).forEach(m=>m.style.visibility="hidden")},restoreAllGuides:()=>{const r=document.getElementById("GUIDES");r&&Array.from(r.children).forEach(m=>m.style.visibility="visible")},removeGuide:r=>{C.delete(r),i.setGuidesData(JSON.stringify(Array.from(C)))},tryToContinueMountGuide:(r,m)=>{const U=K.get(r);U&&typeof(U==null?void 0:U.handleContinue)=="function"&&U.handleContinue(m)},tryToResizeMountGuide:r=>{const m=K.get(r);m&&typeof(m==null?void 0:m.handleResize)=="function"&&m.handleResize()},tryToCloseMountGuide:r=>{const m=K.get(r);m&&typeof(m==null?void 0:m.handleClose)=="function"&&m.handleClose()},registerMountGuideCallback:(r,m)=>{const U=K.get(r)||{};K.set(r,{...U,...m})},removeMountGuideCallback:(r,m)=>{if(!m){K.delete(r);return}const U=K.get(r)||{};K.set(r,{...U,[m]:void 0})}};return V},ee=A=>{let{store:i,commonGuidesData:g,isDesign:B,isPreview:C}=A;MB.commonGuideHelper=x(i,{getGuidesData:()=>g,setGuidesData:updateUserCommonGuidesData},{isDesign:B,isPreview:C})},me=A=>{let{store:i,isDesign:g,isPreview:B}=A;const C={guide:{dashboard_guides:"",workspace_guides:"",square_guides:null,workspace_guides_version:"",default_team_cid:"",root_project_team_cid:"",workspace_guides_2203:"",workspace_guides_2203_version:"",aboard_guides:""},guide_project_template_cid:"",guide_project_template_2203_cid:"",guide_flow_template_cid:"",guide_design_template_cid:"",guide_prototype_template_cid:""},{guide:{workspace_guides:W}}=C;MB.commonGuideHelper=x(i,{getGuidesData:()=>W,setGuidesData:()=>{}},{isDesign:g,isPreview:B})};var G=e(46407),H=e(10629),oe=e(44327),ve=e(55244),Ge=e(15399),Oe=e(47163),Be=e(98033);const _e=A=>{let{initialData:i,designOptions:g,global:B,onUpdateSharing:C}=A;const{user:W,org:K,team:V,preference:r,orgList:m,user_fcg:U,org_fcg:R,space:Z,canEditByCurrentUser:J}=i,{currentUser:ne,currentOrg:re}=(0,Be.n)({user:W,org:K});(0,ve.kZ)((0,Oe.w)()),Object.assign(MB,{user:ne||{},orgList:m,currentOrg:re,canEditByCurrentUser:J,global:{...B,popupHelper:(0,H.L)(),experienceLoginModalHelper:G.F}}),MB.action("current:update:state",{currentOrg:re,currentTeam:V,currentUser:ne,orgList:m,user_fcg:U,org_fcg:R,currentSpace:Z,personalOrg:K}),MB.action("update:design:options",{designOptions:g}),W!=null&&W.id&&MB.action("entry:init:preference",{preference:r}),C&&C()},We=async A=>{let{designStore:i}=A,g="[]";try{const{guide:B}=await requestUserCommonGuidesData();g=B==null?void 0:B.workspace_guides}catch(B){console.error("\u83B7\u53D6 guide_data \u5931\u8D25")}await initCommonGuide({store:i,commonGuidesData:g,isDesign:!0,isPreview:!1})},Fe=async A=>{let{type:i,projectBasicCid:g}=A;switch(i){case DesignType.Design:return requestProjectFullDataFlat(g);case DesignType.Experience:return requestExperienceFullDataFlat(g);default:throw new Error(i+" not found in known design types for "+g)}};var be=e(61232),Ce=e(97109),ye=e(71123),De=e(16810),ie=e(56202);const Ae=A=>{const{isEmbedV1:i=!1}=A||{};return{isDesktop:!((0,ie.Fr)()||i),isInApp:!1,isMultiLink:!1,isMobile:(0,ie.Fr)(),isIOSClient:(0,ie.Hv)(),isStandAlone:(0,ie.Gd)(),isEmbedV1:i,isEmbedV2:!1,isHTMLZip:!1,isUIChina:(0,ie.II)(),isForum:(0,ie.uf)(),isElectron:(0,ie.b8)(),isSquare:!1,isFeishu:(0,ie.Fl)(),isWechat:(0,ie.vq)(),...A}},Ie=A=>{const{isMobile:i,isEmbedV2:g,isSquare:B}=A;return i?ye.A:g||B?Ce.A:De.A};var Ke=e(88334),Me=e(68587);const Re=A=>{let{designOptions:i,previewOptions:g,initialData:B,WMListConfig:C,onComponentDidMount:W,sharing:K}=A,V=!1;(0,Me.FR)();const r=(0,S.s)(MB);_e({initialData:B,designOptions:i,global:{designOptions:i,previewOptions:g}}),(0,Ke.LN)(C);const{isIOSClient:m,isStandAlone:U}=g;(U||m)&&(document.documentElement.style.height="100vh");const{runnerController:R,messageBucket:Z,webpackInterface:J,PreviewApp:ne}=(0,be._)(Ie(g));return Object.assign(MB,{runnerController:R,messageBucket:Z,webpackInterface:J,global:{...MB.global||{},popupHelper:(0,H.L)(),designOptions:i,previewOptions:g}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{previewOptions:g}}),{requestData:async re=>{const{user:pe,org:ge,preference:Pe,project_basic:Te,project_meta:Ue}=B;return me({store:r,isDesign:!0,isPreview:!1}),Object.assign(MB,{tag:Te==null?void 0:Te.version}),MB.action("update:design:options",{designOptions:MB.global.designOptions}),await a({projectMetaCid:Ue.cid}),MB.webpackInterface.store.dispatch({type:"preview:set:current-projectShare",payload:{projectShare:K}}),MB.webpackInterface.store.dispatch({type:"entry:init:preview:preference",payload:{preference:Pe||{}}}),MB.action("entry:handle-tool:preview:view_mode",{previewViewMode:re}),Object.assign(MB,{user:pe||{},canEditByCurrentUser:!1,org:ge||void 0}),MB.webpackInterface.store.dispatch({type:"entry:state:init"}),V=!0,(0,Me.RZ)(),{projectAlike:Te,projectMeta:Ue,projectShare:K}},renderDesign:re=>{let{projectAlike:pe,projectMeta:ge}=re;return V?(0,F.jsx)(Q,{store:r,projectBasic:pe,projectMeta:ge,onComponentDidMount:W,isHtmlZip:!0}):null},renderPreview:re=>{let{projectAlike:pe,projectMeta:ge,projectShare:Pe}=re;return V?((0,d.X)(Pe),(0,F.jsx)(ne,{store:J.store,previewMode:"preview",projectAlike:pe,projectMeta:ge,projectShare:Pe})):null}}};var we=e(67787);const xe=we.Ay.div.withConfig({displayName:"styles__StyledExampleApp",componentId:"sc-1r36j4k-0"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;}.mb-design-page{height:100%;&,#mb-toolbar{transition:all 0.2s ease-in-out;}&.is-collapse{opacity:0;z-index:0;#mb-toolbar{transform:translateY(-100%);}.mb-right-panel{transform:translateX(100%);}}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;transition:all 0.2s ease-in-out;&.is-collapse{opacity:0;z-index:0;}}"]),Ee=we.Ay.div.withConfig({displayName:"styles__StyledROExampleApp",componentId:"sc-1r36j4k-1"})(["&{position:absolute;top:0;left:0;bottom:0;right:0;transition:all 0.2s ease-in-out;}.mb-design-page{height:100%;position:relative;z-index:1;&.is-collapse{opacity:0;z-index:0;}}.mb-preview-page{position:absolute;top:0;left:0;width:100%;bottom:0;font-size:12px;&.is-collapse{opacity:0;z-index:0;}}"]);var ke=e(7198),Le=e(82738),Ne=e(53732),h=e.n(Ne);class l extends o.PureComponent{render(){const{isCollapse:i,renderReadOnly:g,projectAlike:B,projectMeta:C}=this.props;return(0,F.jsx)("div",{ref:W=>this.$element=W,className:h()("mb-design-page",{"is-collapse":i}),children:g({projectAlike:B,projectMeta:C})})}}class b extends o.PureComponent{constructor(i){super(i),(0,E.A)(this,"setElementRef",g=>this.$element=g),MB.f.inPreview=!i.isCollapse}componentDidMount(){this.$element.addEventListener("wheel",this.handleWheel,{passive:!1})}componentWillUnmount(){MB.f.inPreview=!1,this.$element.removeEventListener("wheel",this.handleWheel)}handleWheel(i){(i.ctrlKey||i.metaKey)&&i.preventDefault()}render(){const{isCollapse:i,renderPreview:g,projectAlike:B,projectMeta:C,projectShare:W}=this.props;return(0,F.jsx)("div",{ref:this.setElementRef,className:h()("mb-preview-page",{"is-collapse":i}),children:g({projectAlike:B,projectMeta:C,projectShare:W})})}}var _=e(78796),T=e(98267),j=e(30986),N=e(86769),y=e(3862),Y=e(78915),q=e(22835);const te=(A,i)=>{const{current:{currentProject:g},ui:{toolbar:{isShowSticky:B},leftLayout:{leftPanel:{show:C,width:W},directory:{screen:{currentPage:K},bottom:{height:V},screen:{screenCollapseKeySet:r}}},rightLayout:{rightPanel:{show:m,resizedWidth:U}},fixedLayout:{modals:{previewCanvasModal:R,previewModal:Z}}},editor:{state:{mode:{fullScreenMode:J}}}}=MB.__store__.getState(),ne=()=>{MB.__store__.dispatch({type:"entry:handle-tool:preview:view_mode",payload:{previewViewMode:"device"}});const{pageKey:re,canvasKey:pe}=N.A.validateAndTryCorrectPGAndCVKey(K.key,A,null,g.category===y.t_);MB.webpackInterface.store.dispatch({type:"entry:runner:activate:canvas",payload:{pageKey:re,canvasKey:pe,saveHistory:!1,forceInit:!0,keepScale:!1}}),MB.webpackInterface.store.dispatch({type:"preview:set:leftPaneWidth",payload:{leftPaneWidth:W!=null?W:250}}),MB.webpackInterface.store.dispatch({type:"preview:update:state",payload:{hasChangedScaleManually:!1}}),MB.webpackInterface.store.dispatch({type:"preview:panel:set:height",payload:{panelHeight:V}}),MB.webpackInterface.store.dispatch({type:"preview:set:rightPaneWidth",payload:{rightPaneWidth:U,projectCid:g.cid}}),J&&MB.webpackInterface.store.dispatch({type:"reducer:preview-toolbar:fullscreen",payload:{isFullScreenMode:!0}}),MB.webpackInterface.store.dispatch({type:"ST:update",payload:{STMode:B}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:isMinimized",payload:{isMinimized:!C,isMemorize:!J}}),MB.webpackInterface.store.dispatch({type:"entry:preview-setting:toggle:rightPane",payload:{isShowRightPane:m,isMemorize:!J}}),MB.webpackInterface.store.dispatch({type:"preview:set:collapsedRBPageKeySet",payload:{collapsedRBPageKeySet:r}}),MB.webpackInterface.store.dispatch({type:"entry:preview:toggle:isHiddenToolBar",payload:{value:!1}}),MB.action("modal:reset:state"),MB.action("entry:exit:edit:basket"),MB.__store__.dispatch({type:"entry:comment:disabled",payload:{noWigglingCommentCid:!0}}),MB.__store__.dispatch({type:"versions:update",payload:{isVersionManagementPaneShow:!1}}),MB.__store__.dispatch(Y.GO.toggleInspectMode(!1)),MB.__store__.dispatch(Y.GO.toggleHandMode(!1)),MB.__store__.dispatch(Y.GO.select([])),MB.__store__.dispatch({type:"elbow:update",payload:{isInElbowMode:!1}}),MB.__store__.dispatch({type:"entry:ST:STMode:disable"}),MB.__store__.dispatch({type:"ST:clear"})};R!=null&&R.isOpen||Z!=null&&Z.isOpen?(MB.action("modal:reset:preview:modal:state"),setTimeout(()=>{ne(),i==null||i()},600)):(ne(),i==null||i())},ce=(A,i,g)=>{const{container:{current:{rootProject:B},common:{leftPaneWidth:C,panelHeight:W,rightPaneWidth:K,collapsedRBPageKeySet:V},runner:{activePageKey:r},previewSetting:{isFullScreenMode:m,isMinimized:U,isShowRightPane:R}},ST:{STMode:Z}}=MB.webpackInterface.store.getState(),{ui:{leftLayout:{directory:{screen:{currentPage:J}}}},editor:{state:{mode:{isHtmlZipPreview:ne}}}}=MB.__store__.getState();g==="inspect"?(MB.__store__.dispatch({type:"entry:comment:disabled"}),MB.__store__.dispatch(Y.GO.toggleInspectMode(!1)),MB.__store__.dispatch(Y.GO.toggleHandMode(!1)),MB.__store__.dispatch(Y.GO.select([]))):(J.key!==r&&MB.__store__.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:A,projectMeta:i,screenCid:r,isHtmlZip:ne}}),MB.__store__.dispatch({type:"screen:add:collapseKeySet",payload:{refs:V,projectCid:B.cid}}),m&&MB.__store__.dispatch(Y.GO.toggleFullScreenMode(!0)),MB.webpackInterface.store.dispatch({type:"entry:runner:cleanup:audio"}),MB.webpackInterface.store.dispatch({type:"runner:reset:state:except:history"}),MB.webpackInterface.store.dispatch({type:"container:comment:reset:state"}),MB.webpackInterface.store.dispatch({type:"preview:previewPanel:navindex",payload:{previewPanelNavIndex:0}}),MB.__store__.dispatch({type:"left-panel:set:width",payload:{width:C,projectCid:B.cid}}),MB.__store__.dispatch({type:"directory-panel:bottom:set:height",payload:{height:W}}),MB.__store__.dispatch({type:"right-side-panel:update:resize:width",payload:{width:K,projectCid:B.cid}}),MB.__store__.dispatch({type:"right-side-panel:collapse:panel",payload:{show:R,isMemorize:!m}}),MB.__store__.dispatch({type:"left-panel:collapse:panel:show",payload:{show:!U,isMemorize:!m}}),MB.__store__.dispatch({type:"entry:observe:dom:size:update-viewport-rect"}),MB.__store__.dispatch({type:"entry:isShowSticky:toggle",payload:{isShowSticky:Z}}),requestAnimationFrame(()=>MB.__store__.dispatch({type:"entry:update:viewport:rect"})),MB.webpackInterface.store.dispatch({type:"entry:comment:disabled"}),(0,q.RF)(r))},le=(A,i,g)=>{if(g!=="read_only"){const{container:{current:{rootProject:B},common:{leftPaneWidth:C,panelHeight:W,rightPaneWidth:K,collapsedRBPageKeySet:V},runner:{activePageKey:r},previewSetting:{isFullScreenMode:m,isMinimized:U,isShowRightPane:R}},ST:{STMode:Z}}=MB.webpackInterface.store.getState(),{ui:{leftLayout:{directory:{screen:{currentPage:J}}}},editor:{state:{mode:{isHtmlZipPreview:ne}}}}=MB.__store__.getState();J.key!==r&&MB.__store__.dispatch({type:"entry:root-project:readOnly:activate",payload:{projectBasic:A,projectMeta:i,screenCid:r,isHtmlZip:ne}}),MB.__store__.dispatch({type:"screen:add:collapseKeySet",payload:{refs:V,projectCid:B.cid}}),m&&MB.__store__.dispatch(Y.GO.toggleFullScreenMode(!0)),MB.webpackInterface.store.dispatch({type:"entry:runner:cleanup:audio"}),MB.webpackInterface.store.dispatch({type:"runner:reset:state:except:history"}),MB.webpackInterface.store.dispatch({type:"container:comment:reset:state"}),MB.webpackInterface.store.dispatch({type:"preview:previewPanel:navindex",payload:{previewPanelNavIndex:0}}),MB.__store__.dispatch({type:"left-panel:set:width",payload:{width:C,projectCid:B.cid}}),MB.__store__.dispatch({type:"directory-panel:bottom:set:height",payload:{height:W}}),MB.__store__.dispatch({type:"right-side-panel:update:resize:width",payload:{width:K,projectCid:B.cid}}),MB.__store__.dispatch({type:"right-side-panel:collapse:panel",payload:{show:R,isMemorize:!m}}),MB.__store__.dispatch({type:"left-panel:collapse:panel:show",payload:{show:!U,isMemorize:!m}}),MB.__store__.dispatch({type:"entry:observe:dom:size:update-viewport-rect"}),MB.__store__.dispatch({type:"entry:isShowSticky:toggle",payload:{isShowSticky:Z}}),requestAnimationFrame(()=>{MB.__store__.dispatch({type:"entry:update:viewport:rect"})}),(0,q.RF)(r)}MB.__store__.dispatch({type:"entry:handle-tool:toggle:inspect-mode",payload:{mode:!0}})};class $ extends o.PureComponent{constructor(i){super(i),(0,E.A)(this,"handleWheelChanged",R=>{if(R.deltaX===0)return;const Z=document.getElementById("workspace"),J=Z.scrollLeft+Z.offsetWidth===Z.scrollWidth&&R.deltaX>0,ne=Z.scrollLeft===0&&R.deltaX<0;(J||ne)&&R.preventDefault()}),(0,E.A)(this,"handleDesignDidMount",()=>{MB.reduxEntry.setEntryMap(_.T)}),(0,E.A)(this,"keyboardManager",new ke.Rr);const{viewMode:g,designOptions:B,previewOptions:C,initialData:W,WMListConfig:K,sharing:V}=i;MB.switchToPreview=R=>{this.state.viewMode!=="device"&&((0,T.N8)("device"),te(R),this.setState({viewMode:"device"}))},MB.switchToReadOnly=()=>{if(this.state.viewMode==="read_only")return;const{projectAlike:R,projectMeta:Z,viewMode:J}=this.state;(0,T.N8)("read_only"),ce(R,Z,J),this.setState({viewMode:"read_only"})},MB.switchToInspect=()=>{if(this.state.viewMode==="inspect")return;const{projectAlike:R,projectMeta:Z,viewMode:J}=this.state;(0,T.N8)("inspect"),le(R,Z,J),this.setState({viewMode:"inspect"})},this.state={isDataLoaded:!1,viewMode:g,projectAlike:null,projectMeta:null,projectShare:void 0};const{requestData:r,renderDesign:m,renderPreview:U}=Re({initialData:W,WMListConfig:K,designOptions:B,previewOptions:C,onComponentDidMount:this.handleDesignDidMount,sharing:V});this.requestData=r,this.renderDesign=m,this.renderPreview=U}componentDidMount(){Promise.all([this.requestData(this.state.viewMode)]).then(i=>{let[{projectAlike:g,projectMeta:B,projectShare:C}]=i;this.setState({projectAlike:g,projectMeta:B,projectShare:C},()=>{this.setState({isDataLoaded:!0})});const W=document.getElementById("workspace");W&&W.addEventListener("wheel",this.handleWheelChanged)})}componentWillUnmount(){const i=document.getElementById("workspace");i&&i.removeEventListener("wheel",this.handleWheelChanged,{capture:!0})}render(){const{isDataLoaded:i,viewMode:g,projectAlike:B,projectMeta:C,projectShare:W}=this.state,{renderDesign:K,renderPreview:V}=this;return(0,F.jsx)(j.G.Provider,{value:g,children:(0,F.jsx)(ke.M.Provider,{value:this.keyboardManager,children:(0,F.jsx)(Le.$,{children:(0,F.jsxs)(Ee,{className:"example-app",children:[i&&(0,F.jsx)(l,{isCollapse:!["read_only","inspect"].includes(g),projectAlike:B,projectMeta:C,renderReadOnly:K}),i&&(0,F.jsx)(b,{isCollapse:g!=="device",projectAlike:B,projectMeta:C,projectShare:W,renderPreview:V})]})})})})}}var de=e(16615),se=e(78401),fe=e(54844),X=e(28894);e.p="./mb-proto2/";const Se=document.getElementById("workspace"),ue=async()=>{var A,i;const g=Ae({isHTMLZip:!0});(0,ie.Fr)()&&((A=document.querySelector("body"))==null||A.classList.add("mobile"));let B=await(0,u.Rz)();const{projectUpper:C,projectMeta:W}=B;B={...B,projectName:C.name,project_basic:C,project_meta:W};const{sharing:K}=await(0,fe.J_)({project:C}),V=await(0,u.CS)(),{generateLang:r}=await X.qu.loadLLG();await r(),document.title=""+(0,se.qk)(C.name||C.title),!ENV.IS_ON_PREMISES&&(0,de.I2)();const m=(i=new URLSearchParams(location.search))==null?void 0:i.get("view_mode"),U=window.HZv5_PREVIEW_MODE||"",R=m||U,Z=["device","read_only","inspect"].includes(R)?R:"read_only",J={isDesign:!0,isExperience:!1,isLoggedExperience:!1};(0,f.createRoot)(Se).render((0,F.jsx)($,{initialData:B,WMListConfig:V,viewMode:Z,designOptions:J,previewOptions:g,sharing:K}))};document.addEventListener("DOMContentLoaded",async()=>{await ue()})},42459:(n,w,e)=>{e.d(w,{$G:()=>L,Op:()=>P,Uj:()=>p,XB:()=>u,be:()=>c,fQ:()=>S,nK:()=>M,u5:()=>D});const f=(t,a,O)=>{if(t[a]===O)return t;const x=[...t];return x[a]=O,x},u=(t,a)=>a>=0&&a<=t.length-1?[...t.slice(0,a),...t.slice(a+1)]:t,M=(t,a,O)=>[...t.slice(0,a),O,...t.slice(a)],c=(t,a,O)=>O===a?t:O<a?[...t.slice(0,O),...t.slice(O+1,a+1),t[O],...t.slice(a+1)]:[...t.slice(0,a),t[O],...t.slice(a,O),...t.slice(O+1)],D=(t,a)=>[...t,a],I=(t,a)=>[a,...t],k=t=>{if(t.length===0)return t;const a=[...t];return a.pop(),a},E=t=>{if(t.length===0)return t;const a=[...t];return a.shift(),a},o=(t,a)=>a&&a.length?[...t,...a]:t,S=(t,a)=>t.includes(a)?t:[...t,a],p=(t,a)=>{const O=t.indexOf(a);return~O?[...t.slice(0,O),...t.slice(O+1)]:t},s=(t,a,O)=>{const x=t.indexOf(O);return~x?c(t,a,x):t},P=(t,a)=>{const O=t.findIndex(a);return~O?[...t.slice(0,O),...t.slice(O+1)]:t},d=(t,a,O)=>{const x=t.findIndex(a);return~x?c(t,O,x):t},L=(t,a,O)=>{const x=t.findIndex(a);if(!~x||t[x]===O)return t;const ee=[...t];return ee[x]=O,ee},z=(t,a,O)=>{const x=t.findIndex(a);if(!~x)return[...t,O];if(t[x]===O)return t;const ee=[...t];return ee[x]=O,ee},F=(t,a,O)=>t.find(a)===void 0?[...t,O]:t,Q=(t,a)=>{const O=[];for(let x=0,ee=t.length;x<ee;x+=a)O.push(t.slice(x,x+a));return O}},52563:(n,w,e)=>{e.d(w,{FE:()=>I,Pj:()=>c,Vo:()=>k});var f=e(79371),u=e.n(f);const M=function(E,o,S){S===void 0&&(S=1e3);const p=(s,P)=>{(s==null?void 0:s.size)>o[0]&&console.error("[Oversize "+E+"]",s.size),(P==null?void 0:P.size)>o[1]&&console.error("[Oversize "+E+" effecSet]",P.size)};return u()(p,S)},c=E=>{const o=new Map;return{_map:o,addRef:(d,L)=>{o.has(d)?o.get(d).add(L):o.set(d,new Set([L])),E==null||E(o,o.get(d))},delRef:(d,L)=>{const z=o.get(d);z&&(z.delete(L),z.size||o.delete(d))},getRef:d=>o.get(d),hasRef:(d,L)=>{var z;return(z=o.get(d))==null?void 0:z.has(L)}}},D=E=>{const o=E.hotAttr.interactions;if(!(o!=null&&o.length))return null;const S=new Set;return o.forEach(p=>{const s=p.targetResCanvasKey||p.targetBasketKey||p.targetWidgetKey||p.targetOverlayKey;s&&S.add(s)}),S},I=()=>{const E=M("ItaRefMap",[2e3,200]),{_map:o,addRef:S,delRef:p}=c(E);return{update:(s,P)=>{const{key:d}=s,L=P?D(P):null,z=D(s);z&&[...z].forEach(F=>{S(F,d),L==null||L.delete(F)}),L!=null&&L.size&&[...L].forEach(F=>p(F,d))},delete:s=>{const P=s?D(s):null;P!=null&&P.size&&[...P].forEach(d=>p(d,s.key))},getEffectKeys:s=>o.has(s)?Array.from(o.get(s)):[],clear:()=>{E.flush(),o.clear()},_getMap:()=>o}},k=()=>{const E=M("MktCidRefMap",[2e3,2e3]),{_map:o,addRef:S,delRef:p,hasRef:s}=c(E),P=d=>{if(!d)return;const{mktCid:L,mktUnlock:z}=d.hotAttr;return L&&!z?L:void 0};return{update:(d,L)=>{const{key:z}=d,F=P(L),Q=P(d);Q&&Q!==F&&(Q&&!sdkStore.findUpHotItemList(z).some(t=>s(Q,t.key))&&S(Q,z),F&&p(Q,z))},delete:d=>{if(d){const L=P(d);L&&p(L,d.key)}},getEffectKeys:d=>o.has(d)?Array.from(o.get(d)):[],clear:()=>{E.flush(),o.clear()},isEmpty:()=>!o.size,_getMap:()=>o}}},56202:(n,w,e)=>{e.d(w,{Bd:()=>a,Fl:()=>I,Fr:()=>p,Gd:()=>z,H8:()=>E,Hv:()=>L,II:()=>F,Md:()=>t,VK:()=>me,b8:()=>M,cX:()=>c,gm:()=>o,lg:()=>O,m0:()=>s,nr:()=>S,uF:()=>D,uf:()=>Q,un:()=>d,vq:()=>k});var f,u;const M=()=>window.MB_DESKTOP_VERSION||window.isElectron||/Electron/i.test(navigator.userAgent),c=()=>/(Macintosh)/i.test(navigator.userAgent),D=()=>/(Windows)/i.test(navigator.userAgent),I=()=>/(Lark)/i.test(navigator.userAgent),k=()=>/micromessenger/.test(navigator.userAgent.toLowerCase()),E=()=>/Chrome/i.test(navigator.userAgent),o=()=>/Firefox/i.test(navigator.userAgent),S=()=>/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),p=()=>{const G=new URLSearchParams(location.search);return G&&G.get("inapp")==="1"&&(e.g.isInAPP=!0),/(iPod|iPhone|iPad|Android|MobileClient)/.test(navigator.userAgent)||window.isInAPP},s=()=>/Android/i.test(navigator.userAgent),P=()=>/(iPad)/.test(navigator.userAgent),d=()=>/(iPod|iPhone|iPad)/.test(navigator.userAgent),L=()=>!!(window.webkit&&window.webkit.messageHandlers),z=()=>navigator.standalone,F=()=>/\/uichina$/.test(location.pathname),Q=()=>/\/forum$/.test(location.pathname),t=()=>/(MobileClient)/.test(navigator.userAgent),a=!!(typeof window<"u"&&window.document&&window.document.createElement),O=/(mac|iphone|ipod|ipad)/i.test(typeof navigator<"u"?((f=navigator)==null?void 0:f.platform)||((u=navigator)==null||(u=u.userAgentData)==null?void 0:u.platform):""),x=()=>{var G;if(!((G=navigator)!=null&&G.plugins))return!1;for(const H in navigator.plugins)if(navigator.plugins[H]&&navigator.plugins[H].filename==="np-mswmp.dll")return!0;return!1},ee=G=>{G=G.toLowerCase();const H=G.includes("qihu"),oe=G.includes("360se"),ve=G.includes("360ee");return H&&(oe||ve)},me=()=>{let G,H;const oe=navigator.userAgent;if(H=void 0,G=oe.match(/(opera|chrome|qq|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(G[1]))return H=/\brv[ :]+(\d+)/g.exec(oe)||[],{name:"IE",version:parseFloat(H[1]||"")};if(G[1]==="Chrome"){if(ee(oe)||x())return{name:"360Browser",version:"unknown"};if(/Edg/i.test(oe))return H=oe.match(/Edg\/(\d+)/i),{name:"Edge",version:H?parseFloat(H[1]):"unknown"};if(H=oe.match(/\b(OPR|Edge)\/(\d+)/),H!==null)return{name:H[1].replace("OPR","Opera"),version:parseFloat(H[2])}}return/QQBrowser/i.test(oe)?(H=oe.match(/QQBrowser\/(\d+)/i),{name:"QQBrowser",version:H?parseFloat(H[1]):"unknown"}):(G=G[2]?[G[1],G[2]]:[navigator.appName,navigator.appVersion,"-?"],(H=oe.match(/version\/(\d+)/i))!==null&&G.splice(1,1,H[1]),{name:G[0],version:parseFloat(G[1])})}},58156:(n,w,e)=>{e.d(w,{Z:()=>M,j:()=>c});const f=new Map;let u;const M=D=>{const{key:I,hotAttr:k,sub:E}=D;k.type==="rResBunch"&&k.bunch==="rbPage"&&(u=I),u&&f.set(u,c(u)+1)},c=D=>f.get(D)||0},59128:(n,w,e)=>{e.d(w,{sI:()=>u});const f="_cmt",u=o=>o.endsWith(f),M=o=>{if(u(o))throw new Error("bad datKey: "+o);return""+o+f},c=o=>{if(!u(o))throw new Error("bad cmtKey: "+o);return o.slice(0,-f.length)},D="_cur",I=o=>o.endsWith(D),k=o=>{if(I(o))throw new Error("bad datKey: "+o);return""+o+D},E=o=>{if(!I(o))throw new Error("bad curKey: "+o);return o.slice(0,-D.length)}},79388:(n,w,e)=>{e.d(w,{Ck:()=>Me,F2:()=>xe,LK:()=>ye,sH:()=>be,z0:()=>Fe});var f=e(93093),u=e(37304),M=e(63986),c=e.n(M),D=e(70093),I=e.n(D),k=e(76967),E=e.n(k),o=e(76805),S=e(18833),p=e(47946),s=e(31561),P=e(87612),d=e(83557),L=e(89989),z=e(2399),F=e(34860),Q=e(85449),t=e(55244),a=e(49425),O=e(71577),x=e(50060),ee=e(74222),me=e(58156),G=e(53940),H=e(15515),oe=e(52563),ve=e(9446),Ge=e(68587),Oe=e(39695),Be=e(20089),_e=e(18816),We=e(76613);ENV.IS_SKT_HTTP&&(0,p.pX)(!0),(0,P.Z)(f.wd,u.Z);const Fe=async(h,l)=>{if(console.warn("[onTransferError]",h,l),h==="Tot"||h==="5XX")MB.notice&&MB.notice({text:I18N.Common.offline_alert,duration:32*1e3,showClose:!0,priority:1,type:"super"});else if(h==="4XX"&&l&&/403/.test(l.message)){if(MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.cant_edit,confirmText:I18N.dModule.exit_editing,desc:I18N.dModule.cant_edit_desc}).then(()=>MB.global.onBackButtonClick()),/Error: bad flpak-save/.test(l.message)){var b,_,T;(0,P.p)("saveFlpakError",l,{uId:(b=MB)==null||(b=b.user)==null?void 0:b.id,orgCid:(_=MB)==null||(_=_.currentOrg)==null?void 0:_.cid,projectCid:(T=MB)==null||(T=T.getRootProject())==null?void 0:T.cid})}}else h==="4XX"&&l&&/401/.test(l.message)?(window.onbeforeunload=void 0,MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.err_info_modal.INVALID_COOKIE.title,desc:I18N.dModule.err_info_modal.INVALID_COOKIE.desc,confirmText:I18N.dModule.confirm}).then(()=>(0,S.AG)())):h==="4XX"?(window.onbeforeunload=void 0,MB.global.popupHelper.alertAsyncBlocked({title:I18N.dModule.err_info_modal.INVALID_COOKIE.title,desc:I18N.dModule.err_info_modal.INVALID_COOKIE.desc,confirmText:I18N.dModule.confirm}).then(()=>(0,S.AG)())):await MB.global.popupHelper.alertAsyncBlocked({desc:window.I18N.dModule.unknown_error.replace(/%s/i,status),isHTML:!0})},be=async(h,l)=>{console.warn("[onReadOnlyError]",h,l),h!=="Cur"&&MB.notice&&MB.notice({text:I18N.Common.offline_alert,duration:5*1e3,showClose:!0,priority:1})},Ce=h=>{let{sendCur:l,cssCur:b}=h;const _=()=>{try{if((0,F.oK)()){const j=(0,Q.ll)();if(!j)return;const{container:{runner:{activePageKey:N}}}=j;if(!N)return;l(N,void 0,void 0)}else{const j=(0,Q.dP)();if(!j)return;const{current:{currentScreen:N},screencontainer:{cursorPos:y}}=j,Y=N&&(N.cid||N.key);if(!Y)return;const{x:q,y:te}=y||{};l(Y,q,te)}}catch(T){console.error("cssCur push error",T)}};setInterval(()=>{b.pollRoomChg()&&_()},3*1e3),document.addEventListener("pointermove",_,{passive:!0})},ye=function(h,l){var b;l===void 0&&(l=rootSdk);const _=(0,Q.dP)();if(!_||!MB.action)return;try{(0,O.G_)()}catch(X){console.error(X)}if(((b=rootSdk)==null||(b=b.cssCur)==null?void 0:b.getRoomStat().length)<=1)return;const T=_.ui.leftLayout.directory.screen.contextMenuState;if(T!=null&&T.show&&I()(T.contextScreenSelection,h).length>0){const X=E()(T.contextScreenSelection,h);X.length===0&&MB.action("screen:close:contextmenu"),MB.action("screen:update:contextmenu:contextScreenSelection",X)}const j=_.ui.leftLayout.directory.screen.currentPage,N=_.ui.leftLayout.directory.screen.screenDataMap;j&&h.includes(j.key)&&l.sdkStore.isTrashed(j.key)&&(_.editor.state.mode.basketEditor.refPage?MB.action("entry:update:screen:list"):MB.action("entry:activate:root-project:home-screen"),MB.notice({text:"\u5F53\u524D\u9009\u4E2D\u753B\u5E03\u5DF2\u88AB\u6B63\u5728\u534F\u540C\u7684\u6210\u5458\u5220\u9664",type:"warning"}));const y=l.sdkStore.getHotItem(h[0]);if((y==null?void 0:y.hotAttr.type)==="rResBunch"&&(y==null?void 0:y.hotAttr.bunch)==="rbPage")if(!N[h[0]]||l.sdkStore.isTrashed(h[0]))MB.action("entry:update:screen:list");else{const X=N[h[0]];if(!c()(y==null?void 0:y.hotAttr,X==null?void 0:X.hotAttr)){var Y,q,te,ce,le,$;((X==null||(Y=X.hotAttr)==null?void 0:Y.name)!==(y==null||(q=y.hotAttr)==null?void 0:q.name)||(X==null||(te=X.hotAttr)==null?void 0:te.icon)!==(y==null||(ce=y.hotAttr)==null?void 0:ce.icon)||(X==null||(le=X.hotAttr)==null?void 0:le.zIndex)!==(y==null||($=y.hotAttr)==null?void 0:$.zIndex))&&MB.action("entry:update:screen:list"),(j==null?void 0:j.key)===(y==null?void 0:y.key)&&MB.action("entry:update:current:screen-mata",{screenMeta:{cid:y==null?void 0:y.key,sup:y==null?void 0:y.sup,sub:y==null?void 0:y.sub,...y==null?void 0:y.hotAttr},updateWidgetTreeData:!1})}}const de=_.editor.state.mode.selections,se=de.filter(X=>!l.sdkStore.isTrashed(X));se.length!==de.length&&MB.action("entry:update:selection:select:items",{cids:se});const fe=_.editor.state.mode.hover.item;fe&&l.sdkStore.isTrashed(fe)&&MB.action("mode:update:hover:item","")},De=h=>{ye(h),Ee(h.map(l=>sdkStore.getHotItem(l)).filter(l=>{var b;return(l==null||(b=l.hotAttr)==null?void 0:b.type)==="wChart"}))},ie={repaint:h=>{let{type:l,payload:b}=h;l===s.a&&De(b.changedKeyList)}},Ae=(0,o.nF)(()=>{!(0,Q.dP)()||!MB.action||MB.action("entry:comment:rebuild:commentList")},.5*1e3),Ie={repaint:h=>{let{type:l,payload:b}=h;l===L.a&&Ae()}},Ke=async h=>{let{projectBasicCid:l}=h;try{const{userId:b,flatKey:_,sclibKey:T}=await fetchGetJSON("/api/flat/web_v1/proj2-edit-info?prj2Cid="+l);return{userId:b,flatKey:_,sclibKey:T}}catch(b){await apiErrorModals(b)}},Me=h=>{var l,b;return{...(0,Oe.nF)(),interactionTrigger:"timer",timerDuration:h.aniDelay||"0",targetWidgetKey:We.rE,animationName:h.aniName,animationDuration:Number(((l=h.aniDuration)!=null?l:"1").replace("s",""))*1e3,transitionDelay:h.aniDelay||"0",iterationCount:(b=h.aniCount)!=null?b:"1"}},Re=(h,l,b)=>{try{if(Object.hasOwn(l,"animation")&&Object.hasOwn(l,"interactions")){const _=l.animation;_.aniName&&_.aniName!=="none"&&b.push([h,{animation:{..._,aniName:"none"},interactions:[...l.interactions||[],Me(_)]}])}}catch(_){console.error(_)}},we=h=>{let{sdk:l=sdkStore,rootKey:b=ee.$k,initWM:_,convertItaAniPairList:T}=h;const j=[],N=Date.now();return new Promise(y=>{const Y=new Set,q=[],te=(0,oe.Pj)(),ce=$=>{Ee(j),_==null||_(Array.from(te._map.keys()),te._map),Y.clear(),y($)},le=$=>{if(Y.has($))return;Y.add($);const de=l.getHotItem($);if(!de)return;(0,x.pE)(de.key,void 0,!0);const{hotAttr:se,sub:fe}=de;se.type===Be.x.WChart&&j.push(de),(0,me.Z)(de);let X=fe;if(se.type==="rResBunch"&&se.bunch==="rbPage"&&(X=[],fe.forEach(ue=>{var A;((A=l.getHotItem(ue))==null?void 0:A.hotAttr.bunch)==="rbPage"?q.push(ue):X.push(ue)})),se.type==="wBasket"&&["bDanli","bMuban"].includes(se.basket)){var Se;X=((Se=sdkStore.getHotItem(se.refRBPageKey))==null?void 0:Se.sub)||[]}if(_){const{mktCid:ue,mktUnlock:A}=se;ue&&!A&&te.addRef(ue,$)}for(const ue of X)le(ue);T&&Re($,se,T)};for(b!==ee.$k&&q.push(b),q.push(...l.getHotItem(ee.$k).sub);q.length;){const $=q.shift();if(!(!$||Y.has($))){if(Date.now()-N>3e3){ce(!1);return}le($)}}ce(!0)})},xe=async(h,l,b)=>{try{var _,T;const N=Date.now();performance.mark("setupSDK:start"),ENV.IS_ON_PREMISES&&(0,z.F)();const y=await(0,p.ur)(h),Y=y.sdkStore.createRoSdkStore();Object.assign(globalThis,{...y,rootSdk:y,roSdkStore:Y}),Ce(y),y.sdkStore.subscribe(ie.repaint),y.cmtStore.subscribe(Ie.repaint);const q=l&&(0,F.OB)();q&&((0,a.nU)(y.flatStore,l),(0,a.lb)(y.flatStore),(0,a.th)(y.flatStore),(0,a.Uh)(y.flatStore),(0,a.TK)(y.flatStore),(0,a.a3)(y.flatStore,l)),performance.measure("setupSDK","setupSDK:start");let te=(_=(0,H.Yt)(G.NF+"-"+(l==null?void 0:l.cid),"",H.qW.String).split(","))==null?void 0:_[0];const ce=((T=y.sdkStore.getHotItem(ee.$k))==null?void 0:T.sub)||[];(!te||!ce.includes(te))&&(te=ce[0]||ee.$k),performance.mark("walkInitTree:start");const le=[],$=await we({sdk:y.sdkStore,rootKey:te,initWM:b,convertItaAniPairList:q?le:void 0});(0,x.sk)(),q&&$&&Date.now()-N<1e4&&((0,x.Uk)(),le.length>0&&y.sdkStore.updateHotAttrMergeBatch(le)),performance.measure("walkInitTree","walkInitTree:start")}catch(N){var j;const y=N?Number(N.status)||Number((j=N.toString().split("status")[1])==null||(j=j.split(":")[1])==null?void 0:j.split(",")[0]):void 0;console.warn("[initRootSdk]",N,y),(0,P.p)("initRootSdk",N,{status:y,sdkOption:h,projectBasic:l}),await(0,S.FY)({status:y}),await new Promise(()=>{})}},Ee=h=>{const l=[_e.h.Map100000.loadMLG()];for(const b of h){const{chartType:_,mapAdCode:T}=b.hotAttr.chartConfig;if(_==="map_chart"){const j=_e.h["Map"+T];j.hasMLG()||l.push(j.loadMLG())}}return Promise.all(l)},ke=h=>async l=>{let{fssDat:b}=l;try{const _=await b.loadSOS();if(!_)return;if(console.warn("[afterStoreCreate] found unsaved proj tree",_),await MB.global.popupHelper.confirmAsync({isClose:!0,isHTML:!0,title:"\u6062\u590D\u6570\u636E",desc:["<p>\u68C0\u6D4B\u5230\u672A\u6210\u529F\u4FDD\u5B58\u5230\u4E91\u7AEF\u7684\u6587\u4EF6\u6570\u636E\uFF0C\u6700\u540E\u8BB0\u5F55\u65F6\u95F4\u4E3A\uFF1A"+getFormatDateString(new Date(_.time).getTime(),"","-")+"\u3002</p>","<p>\u662F\u5426\u6062\u590D\u6570\u636E\u5230\u65B0\u6587\u4EF6\uFF1F</p>"].join(""),confirmText:"\u6062\u590D"})){const{clientData:{upperCid:j}}=await newFlpakFromTree(_.tree,h.team_cid,{...h,name:h.name+"-\u6062\u590D\u6570\u636E"}).catch(async N=>{await MB.global.popupHelper.alertAsync({title:"\u6062\u590D\u5931\u8D25",desc:"\u672A\u6210\u529F\u6062\u590D\u6570\u636E\u5230\u65B0\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u52A0\u8F7D\u9875\u9762\u5E76\u91CD\u8BD5\u3002\u62A5\u9519\u4FE1\u606F\uFF1A"+(N.message||String(N))}),location.reload(),await setTimeoutAsync(1e9)});await b.freeSOS(),location.href="/proto/design/"+j}else await b.freeSOS()}catch(_){toSentry("loadSOS err",_)}},Le=window.Worker&&window.DecompressionStream&&window.ReadableStream&&window.location.protocol.startsWith("http"),Ne=h=>{if(!Le)return;let l,b;return{onStatFlpak:(_,T)=>{if(_!==h)return;globalStore.init(T);const{currentSize:j,isFlpakSizeWarn:N}=globalStore.getFlpakSizeInfo();b=N,N&&(l="\u9879\u76EE\u4F53\u79EF\u8F83\u5927(\u7EA6"+j+"M)\uFF0C\u8BF7\u7A0D\u7B49..."),updateLoadingProgress({value:10,nextVlue:20,text:l,message:"fetched"})},onParseFlpak:_=>{let{part:T,rate:j}=_;const N=b?50:70;updateLoadingProgress({value:10+Math.floor(j*N/100),nextVlue:N+10,text:l,message:"parse-"+T})},onTransferItems:(_,T)=>{const j=b?30:10;updateLoadingProgress({value:90-j+Math.floor(_/T*j),nextVlue:95,text:l,message:"transfer"})}}}},88334:(n,w,e)=>{e.d(w,{LN:()=>S,uT:()=>k});var f=e(85449),u=e(67771),M=e(79371),c=e.n(M);const D=p=>{var s,P;const d={type:"reducer:watermark:update-state",payload:p};(s=MB.__store__)==null||s.dispatch(d),(P=MB.webpackInterface)==null||(P=P.store)==null||P.dispatch(d)},I=function(p,s){s===void 0&&(s=sdkStore);const P=new Set;return s.walkHotItemSubtree2(p,d=>{d.hotAttr.mktCid&&P.add(d.hotAttr.mktCid)}),[...P]},k=c()(async p=>{let s=(0,f.fV)();if(!s)return{mdWMMktList:new Set,mtWMMktList:new Set,noWMMktList:new Set};const{mdWMMktList:P,mtWMMktList:d,noWMMktList:L}=s,z=p.filter(O=>!P.has(O)&&!d.has(O)&&!L.has(O)),F=await(0,u.E5)(z);s=(0,f.fV)();const Q=new Set([...s.mdWMMktList].concat(F.mdWMMktList)),t=new Set([...s.mtWMMktList].concat(F.mtWMMktList)),a=new Set([...s.noWMMktList].concat(F.noWMMktList));return D({mdWMMktList:Q,mtWMMktList:t,noWMMktList:a}),{mdWMMktList:Q,mtWMMktList:t,noWMMktList:a}},1e3),E=async p=>{const s=await splitMktListByCid(p),P=new Set(s.mdWMMktList),d=new Set(s.mtWMMktList),L=new Set(s.noWMMktList);return D({mdWMMktList:P,mtWMMktList:d,noWMMktList:L}),{mdWMMktList:P,mtWMMktList:d,noWMMktList:L}},o=p=>{const s=new Set,P=new Set,d=new Set(p);D({mdWMMktList:s,mtWMMktList:P,noWMMktList:d})},S=p=>{const s=new Set((p==null?void 0:p.md_vip_mkt_list)||[]),P=new Set((p==null?void 0:p.mt_vip_mkt_list)||[]),d=new Set((p==null?void 0:p.no_wm_mkt_list)||[]);D({mdWMMktList:s,mtWMMktList:P,noWMMktList:d})}},94994:n=>{n.exports=dompurify}},he={};function v(n){var w=he[n];if(w!==void 0)return w.exports;var e=he[n]={id:n,loaded:!1,exports:{}};return ae[n].call(e.exports,e,e.exports,v),e.loaded=!0,e.exports}v.m=ae,v.amdO={},(()=>{var n=[];v.O=(w,e,f,u)=>{if(e){u=u||0;for(var M=n.length;M>0&&n[M-1][2]>u;M--)n[M]=n[M-1];n[M]=[e,f,u];return}for(var c=1/0,M=0;M<n.length;M++){for(var[e,f,u]=n[M],D=!0,I=0;I<e.length;I++)(u&!1||c>=u)&&Object.keys(v.O).every(s=>v.O[s](e[I]))?e.splice(I--,1):(D=!1,u<c&&(c=u));if(D){n.splice(M--,1);var k=f();k!==void 0&&(w=k)}}return w}})(),v.n=n=>{var w=n&&n.__esModule?()=>n.default:()=>n;return v.d(w,{a:w}),w},(()=>{var n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,w;v.t=function(e,f){if(f&1&&(e=this(e)),f&8||typeof e=="object"&&e&&(f&4&&e.__esModule||f&16&&typeof e.then=="function"))return e;var u=Object.create(null);v.r(u);var M={};w=w||[null,n({}),n([]),n(n)];for(var c=f&2&&e;(typeof c=="object"||typeof c=="function")&&!~w.indexOf(c);c=n(c))Object.getOwnPropertyNames(c).forEach(D=>M[D]=()=>e[D]);return M.default=()=>e,v.d(u,M),u}})(),v.d=(n,w)=>{for(var e in w)v.o(w,e)&&!v.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:w[e]})},v.f={},v.e=n=>Promise.all(Object.keys(v.f).reduce((w,e)=>(v.f[e](n,w),w),[])),v.u=n=>""+({214:"lazy-lib-paper",437:"lazy-lib-fontkit",703:"lazy-lib-rehype",956:"lazy-lib-i18n",976:"lazy-lib-dl"}[n]||n)+"-"+{214:"5a9908939d850d4cae67",338:"c54d13d349fa75ff3f85",437:"94d1920236ee8aff3185",703:"013772de7c49f3c667fa",956:"c78306cfab45779a74a4",976:"ef4a8eb58075f96842b2"}[n]+".js",v.miniCssF=n=>{},v.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(n){if(typeof window=="object")return window}}(),v.o=(n,w)=>Object.prototype.hasOwnProperty.call(n,w),(()=>{var n={},w="@mb2024/mb-proto:";v.l=(e,f,u,M)=>{if(n[e]){n[e].push(f);return}var c,D;if(u!==void 0)for(var I=document.getElementsByTagName("script"),k=0;k<I.length;k++){var E=I[k];if(E.getAttribute("src")==e||E.getAttribute("data-webpack")==w+u){c=E;break}}c||(D=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,v.nc&&c.setAttribute("nonce",v.nc),c.setAttribute("data-webpack",w+u),c.src=e),n[e]=[f];var o=(p,s)=>{c.onerror=c.onload=null,clearTimeout(S);var P=n[e];if(delete n[e],c.parentNode&&c.parentNode.removeChild(c),P&&P.forEach(d=>d(s)),p)return p(s)},S=setTimeout(o.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=o.bind(null,c.onerror),c.onload=o.bind(null,c.onload),D&&document.head.appendChild(c)}})(),v.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},v.nmd=n=>(n.paths=[],n.children||(n.children=[]),n),v.j=699,v.p="/mb-proto2/",(()=>{v.b=document.baseURI||self.location.href;var n={699:0};v.f.j=(f,u)=>{var M=v.o(n,f)?n[f]:void 0;if(M!==0)if(M)u.push(M[2]);else{var c=new Promise((E,o)=>M=n[f]=[E,o]);u.push(M[2]=c);var D=v.p+v.u(f),I=new Error,k=E=>{if(v.o(n,f)&&(M=n[f],M!==0&&(n[f]=void 0),M)){var o=E&&(E.type==="load"?"missing":E.type),S=E&&E.target&&E.target.src;I.message="Loading chunk "+f+" failed.\n("+o+": "+S+")",I.name="ChunkLoadError",I.type=o,I.request=S,M[1](I)}};v.l(D,k,"chunk-"+f,f)}},v.O.j=f=>n[f]===0;var w=(f,u)=>{var[M,c,D]=u,I,k,E=0;if(M.some(S=>n[S]!==0)){for(I in c)v.o(c,I)&&(v.m[I]=c[I]);if(D)var o=D(v)}for(f&&f(u);E<M.length;E++)k=M[E],v.o(n,k)&&n[k]&&n[k][0](),n[k]=0;return v.O(o)},e=self.webpackChunk_mb2024_mb_proto=self.webpackChunk_mb2024_mb_proto||[];e.forEach(w.bind(null,0)),e.push=w.bind(null,e.push.bind(e))})(),v.nc=void 0,v.O(void 0,[31,788,908,347],()=>v(97935));var je=v.O(void 0,[31,788,908,347],()=>v(28501));je=v.O(je)})();

//# sourceMappingURL=preview-html-zip-8b9ce8aee7edf719eab8.js.map